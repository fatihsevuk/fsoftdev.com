I"õ^<h4 id="baÅŸlangÄ±Ã§">BaÅŸlangÄ±Ã§</h4>
<p>Merhabalar, Docker ile Spring Boot uygulamasÄ± geliÅŸtirmeyi anlattÄ±ÄŸÄ±mÄ±z yazÄ± dizisine kaldÄ±ÄŸÄ±mÄ±z yerden devam ediyoruz. Bir Ã¶nceki yazÄ±mÄ±zda Dockerâ€™a giriÅŸ yapmÄ±ÅŸtÄ±k. Bu yazÄ±da Spring Boot uygulamamÄ±zÄ± paketleyip Docker Containerâ€™Ä± iÃ§ine kopyalayÄ±p Ã§alÄ±ÅŸtÄ±racaÄŸÄ±z.</p>

<p>Bu yazÄ±da sÄ±rasÄ±yla ÅŸu adÄ±mlarÄ± gerÃ§ekleÅŸtireceÄŸiz.</p>

<ul>
  <li>Basit bir Spring Boot REST API oluÅŸturacaÄŸÄ±z.</li>
  <li>REST APIâ€™mÄ±zÄ± Jar olarak paketleyeceÄŸiz.</li>
  <li>UygulmanÄ±n Environmentâ€™Ä±nÄ± iÃ§eren Docker Imageâ€™Ä±nÄ± indireceÄŸiz.</li>
  <li>OluÅŸan JAR paketimizi Container iÃ§ine kopyalayacaÄŸÄ±z.</li>
  <li>Son olarak uygulamamÄ±zÄ± Ã§alÄ±ÅŸtÄ±racaÄŸÄ±z.</li>
</ul>

<h4 id="spring-boot-rest-api-oluÅŸturma">Spring Boot Rest API OluÅŸturma</h4>

<p>Spring Boot uygulamamÄ±zÄ± <a href="https://start.spring.io/">Spring Initializr</a> sitesindeki arayÃ¼z yardÄ±mÄ± ile oluÅŸturalÄ±m.</p>

<p><img src="/assets/img/posts/spring-boot-docker-2/spring-boot-initializr.png" alt="Image of spring initializr" /></p>

<p>Bu sayfada Spring Boot uygulamamÄ±zÄ±n ilgili alanlarÄ± seÃ§iyoruz ve en alttaki kÄ±sÄ±mda dependency olarak uygulamamÄ±z iÃ§in gerekli baÄŸÄ±lÄ±lÄ±klarÄ± seÃ§iyoruz. Generate butonuna basÄ±nca oluÅŸan proje zip olarak bilgisayarÄ±mÄ±za iniyor. Bu uygulamada baÄŸÄ±mlÄ±lÄ±k olarak Spring Webâ€™i ve Spring Devtoolsâ€™u seÃ§memiz yeterli. Ä°nen zip dosyasÄ±nÄ± IDEâ€™mizde aÃ§Ä±yoruz.</p>

<p>pom. xml dosyamÄ±zÄ± inceleyecek olursak.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
	<span class="nt">&lt;parent&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>2.2.4.RELEASE<span class="nt">&lt;/version&gt;</span>
		<span class="nt">&lt;relativePath/&gt;</span> <span class="c">&lt;!-- lookup parent from repository --&gt;</span>
	<span class="nt">&lt;/parent&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>com.fsoftdev.blog<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>SpringBootRestHello<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;name&gt;</span>SpringBootRestHello<span class="nt">&lt;/name&gt;</span>
	<span class="nt">&lt;packaging&gt;</span>jar<span class="nt">&lt;/packaging&gt;</span>
	<span class="nt">&lt;description&gt;</span>Demo project for Spring Boot<span class="nt">&lt;/description&gt;</span>

	<span class="nt">&lt;properties&gt;</span>
		<span class="nt">&lt;java.version&gt;</span>1.8<span class="nt">&lt;/java.version&gt;</span>
	<span class="nt">&lt;/properties&gt;</span>

	<span class="nt">&lt;dependencies&gt;</span>
		<span class="nt">&lt;dependency&gt;</span>
			<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>

		<span class="nt">&lt;dependency&gt;</span>
			<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId&gt;</span>spring-boot-devtools<span class="nt">&lt;/artifactId&gt;</span>
			<span class="nt">&lt;scope&gt;</span>runtime<span class="nt">&lt;/scope&gt;</span>
			<span class="nt">&lt;optional&gt;</span>true<span class="nt">&lt;/optional&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>
		<span class="nt">&lt;dependency&gt;</span>
			<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
			<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-test<span class="nt">&lt;/artifactId&gt;</span>
			<span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
			<span class="nt">&lt;exclusions&gt;</span>
				<span class="nt">&lt;exclusion&gt;</span>
					<span class="nt">&lt;groupId&gt;</span>org.junit.vintage<span class="nt">&lt;/groupId&gt;</span>
					<span class="nt">&lt;artifactId&gt;</span>junit-vintage-engine<span class="nt">&lt;/artifactId&gt;</span>
				<span class="nt">&lt;/exclusion&gt;</span>
			<span class="nt">&lt;/exclusions&gt;</span>
		<span class="nt">&lt;/dependency&gt;</span>
	<span class="nt">&lt;/dependencies&gt;</span>

	<span class="nt">&lt;build&gt;</span>
		<span class="nt">&lt;plugins&gt;</span>
			<span class="nt">&lt;plugin&gt;</span>
				<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
				<span class="nt">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
			<span class="nt">&lt;/plugin&gt;</span>
		<span class="nt">&lt;/plugins&gt;</span>
	<span class="nt">&lt;/build&gt;</span>

<span class="nt">&lt;/project&gt;</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p>BirkaÃ§ noktayÄ± revize etmemiz yeterli;</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;packaging&gt;</span>jar<span class="nt">&lt;/packaging&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>ekliyoruz. Bu Mavenâ€™Ä±n projemizi JAR olarak paketlemesi iÃ§in gerekli.</p>

<p>Daha sonra properties etiketleri arasÄ±na aÅŸaÄŸÄ±daki kodlarÄ± ekleyelim.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;java.version&gt;</span>1.8<span class="nt">&lt;/java.version&gt;</span>
<span class="nt">&lt;maven-jar-plugin.version&gt;</span>3.1.1<span class="nt">&lt;/maven-jar-plugin.version&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Projemizi basit bir REST API olarak kodlayacaÄŸÄ±z. 2 tane endpointimiz olsun.</p>

<p><code class="highlighter-rouge">/hello</code> endpointimiz ekrana <code class="highlighter-rouge">Hello Guys...</code> diye bir string basÄ±yor.</p>

<p><code class="highlighter-rouge">/date</code> endpointimiz ekrana ÅŸimdiki tarihi basÄ±yor.</p>

<p>AÅŸaÄŸÄ±da <code class="highlighter-rouge">MainController. java</code> isimli Controller sÄ±nÄ±fÄ±mÄ±z var.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.fsoftdev.blog.SpringBootRestHello</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Calendar</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>

<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainController</span> <span class="o">{</span>

<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"hello"</span><span class="o">,</span><span class="n">method</span> <span class="o">=</span> <span class="nc">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">sayHello</span><span class="o">()</span> <span class="o">{</span>
<span class="k">return</span> <span class="s">"Hello Guys..."</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"date"</span><span class="o">,</span><span class="n">method</span> <span class="o">=</span> <span class="nc">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">sayTodaysDate</span><span class="o">()</span> <span class="o">{</span>
<span class="nc">Date</span> <span class="n">today</span> <span class="o">=</span> <span class="nc">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">getTime</span><span class="o">();</span>
<span class="k">return</span> <span class="n">today</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
<span class="o">}</span>

<span class="o">}</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p>UygulamamÄ±zÄ± Run ettiÄŸimizde beklediÄŸimizde beklediÄŸimiz Ã§Ä±ktÄ±larÄ± verdiÄŸini gÃ¶rÃ¼rÃ¼z. Normal ÅŸartlarda Spring Boot uygulamamÄ±z <code class="highlighter-rouge">localhost</code> da Ã§alÄ±ÅŸÄ±yor.
Ana senaryoya dÃ¶necek olursak Spring Boot uygulamamÄ±zÄ± <code class="highlighter-rouge">JAR</code> olarak paketleyip Docker Containerâ€™Ä± iÃ§erisine alÄ±p Ã§alÄ±ÅŸtÄ±racaktÄ±k.</p>

<h4 id="jar-paketi-oluÅŸturmak">JAR Paketi OluÅŸturmak</h4>

<p>Spring Boot uygulamamÄ±zÄ±n JAR paketini oluÅŸturmak iÃ§in <code class="highlighter-rouge">Maven</code> den faydalanÄ±rÄ±z.
pom. xml dosyamÄ±zda plugin olarak tanÄ±mladÄ±ÄŸÄ±mÄ±z <code class="highlighter-rouge">spring-boot-maven-plugin</code> yardÄ±mÄ± ile Mavenâ€™a Spring Boot desteÄŸi saÄŸlarÄ±z.
Uygulama dizininde aÅŸaÄŸÄ±daki komutu verirsek Maven bizim iÃ§in target klasÃ¶rÃ¼ iÃ§ine JAR dosyasÄ±nÄ± oluÅŸturur. Bu komutun Ã§alÄ±ÅŸmasÄ± iÃ§in sisteminizde Mavenâ€™Ä±n kurulu olmasÄ± gerekmektedir.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>mvn clean package
</pre></td></tr></tbody></table></code></pre></div></div>
<p>Enterâ€™e basÄ±p komutu Ã§alÄ±ÅŸtÄ±rdÄ±ÄŸÄ±mÄ±zda Maven uygulamamÄ±zÄ±n testlerini Ã§alÄ±ÅŸtÄ±rÄ±p bizim iÃ§in JAR paketi haline getirir. EÄŸer iÅŸlem baÅŸarÄ±lÄ± olmuÅŸsa aÅŸaÄŸÄ±daki Ã§Ä±ktÄ±larÄ± alÄ±rsÄ±nÄ±z.</p>

<p><img src="/assets/img/posts/spring-boot-docker-2/ss-mvn-package-1.png" alt="Image of mvn-package-1" />
Bu resimde JAR paketinin konumu gÃ¶steriyor. OluÅŸan JAR dosyasÄ±nÄ±n ismini <code class="highlighter-rouge">pom. xml</code> de <code class="highlighter-rouge">build</code> bÃ¶lÃ¼mÃ¼nde <code class="highlighter-rouge">finalName</code> etiketleri arasÄ±nda tanÄ±mlamÄ±ÅŸtÄ±k.</p>

<p><img src="/assets/img/posts/spring-boot-docker-2/ss-mvn-package-2.png" alt="Image of mvn-package-1" />
Burada da iÅŸlemin baÅŸarÄ±yla sonuÃ§landÄ±ÄŸÄ± ve ne kadar sÃ¼rede gerÃ§ekleÅŸtiÄŸini gÃ¶rÃ¼yoruz.</p>

<h4 id="jdk-iÌ‡Ã§in-container-oluÅŸturma">JDK Ä°Ã§in Container OluÅŸturma</h4>

<p>Evet elimizde JAR dosyamÄ±z var artÄ±k sÄ±rada JDK Docker Imageâ€™ini indirip Ã§alÄ±ÅŸtÄ±rmak var. Bunun iÃ§in aÅŸaÄŸÄ±daki komutu veririz.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>docker run -dit openjdk:8-jdk-alpine
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Alpine, Alpine Linux temelli minimal bir Docker Imageâ€™dir. Yani yukarÄ±daki komut bizim iÃ§in minimal bir Linux kurulumu yapacak ve iÃ§erisine JDKâ€™yÄ± kuracak ne bÃ¼yÃ¼k kolaylÄ±k de mi?
YukarÄ±daki komutu Ã§alÄ±ÅŸtÄ±rdÄ±ÄŸÄ±mÄ±z da Docker localâ€™de openjdk:8-jdk-alpine Imageâ€™i arar bulamazsa Docker Hubâ€™dan indirir, sonra bu Imageâ€™i Ã§alÄ±ÅŸtÄ±rÄ±r. Peki <code class="highlighter-rouge">-dit</code> ayarÄ± ne demek bu Docker Documentationâ€™dan yardÄ±m alacak olursak. <code class="highlighter-rouge">-dit</code> aslÄ±nda 3 option iÃ§eriyor. Bunlar <code class="highlighter-rouge">-d</code>,<code class="highlighter-rouge">-i</code>,<code class="highlighter-rouge">-t</code> dir.</p>

<p><code class="highlighter-rouge">-d</code>: Containerâ€™Ä± detach modda Ã§alÄ±ÅŸtÄ±rÄ±r yani Container Ã§alÄ±ÅŸÄ±yor aynÄ± zamanda aynÄ± terminalde baÅŸka komutlar girmemize olanak saÄŸlÄ±yor. Yani Container arka planda Ã§alÄ±ÅŸmÄ±ÅŸ oluyor. -d aynÄ± zamanda Container Idâ€™sinide dÃ¶ner.</p>

<p><code class="highlighter-rouge">-i</code>:Containerâ€™Ä± interactive hale getirir. STDINâ€™i aÃ§Ä±k tutar.</p>

<p><code class="highlighter-rouge">-t</code>: Containerâ€™a sÃ¶zde bir TTY atar. <code class="highlighter-rouge">-it</code> sayesinde Containerâ€™Ã¼zerinde komut Ã§alÄ±ÅŸtÄ±rmamÄ±z olanaklÄ± hale gelir.</p>

<p>Evet yukarÄ±daki komutu Ã§alÄ±ÅŸtÄ±ralÄ±m ve ne olduÄŸunu gÃ¶zlemleyelim.</p>

<p><img src="/assets/img/posts/spring-boot-docker-2/ss-docker-run-1.png" alt="Image of docker-run-1" /></p>

<p>Resimde de gÃ¶rdÃ¼ÄŸÃ¼nÃ¼z Ã¼zere Docker ilk Ã¶nce Imageâ€™Ä± localde arÄ±yor fakat bulamÄ±yor sonra Docker Hubâ€™dan indiriyor ve detach modda ve Ã¼zerinde komut Ã§alÄ±ÅŸtÄ±rmaya hazÄ±r bir ÅŸekilde Ã§alÄ±ÅŸtÄ±rÄ±yor. Geriye Ã§alÄ±ÅŸan Containerâ€™Ä±n Ä°d sini dÃ¶nÃ¼yor.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>docker container ls
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Komutuyla Containerâ€™Ä±n Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± gÃ¶zlemleyebiliriz.</p>

<p><img src="/assets/img/posts/spring-boot-docker-2/ss-docker-run-2.png" alt="Image of docker-run-2" /></p>

<p>Evet Containerâ€™Ä±mÄ±z Ã§alÄ±ÅŸÄ±r durumda peki bundan sonra ne yapacaÄŸÄ±z? Gelin Container Ã¼zerinde komut Ã§alÄ±ÅŸtÄ±rabiliyor muyuz ona bakalÄ±m. Ã‡Ã¼nkÃ¼ <code class="highlighter-rouge">-dit</code> optionu ile bunu saÄŸladÄ±ÄŸÄ±mÄ±zÄ± dÃ¼ÅŸÃ¼nÃ¼yoruz.</p>

<p>Åu anda Ã§alÄ±ÅŸan Containerâ€™Ä±mÄ±z iÃ§erisinde JDK barÄ±ndÄ±ran minimal bir Linux daÄŸÄ±tÄ±mÄ±dÄ±r. Acaba bu Linux daÄŸÄ±tÄ±mÄ±z Ã¼zerinde Ã§alÄ±ÅŸan JDK versiyonu nedir. Bunu Ã¶ÄŸrenmek iÃ§in Containerâ€™Ä±mÄ±z Ã¼zerinde <code class="highlighter-rouge">java -verison</code> komutu Ã§alÄ±ÅŸtÄ±ralÄ±m bakalÄ±m neler olacak.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>docker exec vigilant_goldberg java -verison
</pre></td></tr></tbody></table></code></pre></div></div>
<p>YukarÄ±daki komutta <code class="highlighter-rouge">vigilant_goldberg</code> Ã§alÄ±ÅŸan Containerâ€™Ä±mÄ±zÄ±n ismidir.</p>

<p>Komutumuzun aÅŸaÄŸÄ±daki gibi oldu.</p>

<p><img src="/assets/img/posts/spring-boot-docker-2/ss-docker-exec-1.png" alt="Image of ss-docker-exec-1" /></p>

<p>Evet Containerâ€™Ä±mÄ±z Ã§alÄ±ÅŸÄ±yor ve Ã¼zerinde Java 8 sÃ¼rÃ¼mÃ¼ Ã§alÄ±ÅŸÄ±yor.</p>

<h4 id="jar-paketini-container-iÌ‡Ã§ine-kopyalama">JAR Paketini Container Ä°Ã§ine Kopyalama</h4>

<p>Åimdi sÄ±ra Jar olarak paketlediÄŸimiz Spring Boot uygulamasÄ±nÄ± Container iÃ§ine kopyalamaya geldi. Bunu yapmak iÃ§in aÅŸaÄŸÄ±daki komutu kullanÄ±rÄ±z. Åu anda Spring Boot uygulamamÄ±zÄ±n ana dizininde olduÄŸumuzu varsayÄ±yorum deÄŸilsek o dizine gidelim.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>docker container cp target/SpringBootRestHello-0.0.1-SNAPSHOT.jar vigilant_goldberg:/tmp
</pre></td></tr></tbody></table></code></pre></div></div>
<p>Bu komut ile uygulamamÄ±zÄ±n <code class="highlighter-rouge">target dizini altÄ±ndaki jar dosyamÄ±zÄ±</code> <code class="highlighter-rouge">Container iÃ§indeki tmp klasÃ¶rÃ¼ altÄ±na</code> kopyalÄ±yoruz. EÄŸer Container iÃ§in tmp dizini yoksa tmp adÄ±nda yeni bir dizin oluÅŸturulur. Komutun Ã§alÄ±ÅŸÄ±p Ã§alÄ±ÅŸmadÄ±ÄŸÄ±nÄ± Container Ã¼zerinde aÅŸaÄŸÄ±daki komutu Ã§alÄ±ÅŸtÄ±rarak kontrol edebiliriz. EÄŸer doÄŸru bir ÅŸekilde Ã§alÄ±ÅŸmÄ±ÅŸsa Container iÃ§ine tmp adÄ±nda bir dizin oluÅŸmuÅŸ ve iÃ§erisine JAR kopyalanmÄ±ÅŸtÄ±r.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>docker exec vigilant_goldberg ls /tmp
</pre></td></tr></tbody></table></code></pre></div></div>
<p>bu komut aÅŸaÄŸÄ±daki Ã§Ä±ktÄ±yÄ± Ã¼retir.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>SpringBootRestHello-0.0.1-SNAPSHOT.jar

</pre></td></tr></tbody></table></code></pre></div></div>

<p>Evet JAR dosyamÄ±zÄ± Container iÃ§erisine kopyaladÄ±k. Son olarak Containerâ€™Ä±mÄ±zÄ± bu haliyle Image olarak kaydedeceÄŸiz ve baÅŸlangÄ±Ã§ Scriptâ€™i olarak Jar dosyamÄ±zÄ± Ã§alÄ±ÅŸtÄ±rmasÄ±nÄ± ayarlayacaÄŸÄ±z. Yani son durumda Spring Boot uygulamamÄ±z tÃ¼m baÄŸÄ±mlÄ±lÄ±klarÄ±na sahip ve daÄŸÄ±tÄ±labilir bir Docker Imageâ€™i haline gelecek.</p>

<p>Contianerâ€™Ä± Image olarak kaydetmek iÃ§in aÅŸaÄŸÄ±daki komut kullanÄ±lÄ±r.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>docker container commit containerName newName:Tag
</pre></td></tr></tbody></table></code></pre></div></div>
<p>Burada <code class="highlighter-rouge">containerName</code> ilgili Containerâ€™Ä±mÄ±zÄ±n adÄ± <code class="highlighter-rouge">newName</code> ve <code class="highlighter-rouge">tag</code> da yeni oluÅŸacak Imageâ€™e verilecek isim ve tag bilgisidir. Containerâ€™Ä±mÄ±zÄ± bu ÅŸekilde commit yaparsak iÃ§erisnde JAR olan bir Container olur, bu JARâ€™Ä±n Ã§alÄ±ÅŸmasÄ±nÄ± istiyorsak Containerâ€™a JARâ€™Ä± Ã§alÄ±ÅŸtÄ±racak komutlarÄ± manuel olarak vermemiz gerekir ve Containerâ€™Ä±n olasÄ± durdurulma durumlarÄ±nda JARâ€™Ä± tekrar baÅŸlatmamÄ±z gerekir. Bu durumu daha efektif hale getirmek iÃ§in Container her baÅŸladÄ±ÄŸÄ±nda ilgili JAR dosyasÄ±nÄ± Ã§alÄ±ÅŸmasÄ±nÄ± ayarlayabiliriz bunu aÅŸaÄŸÄ±daki gibi yaparÄ±z.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>docker container commit --change='CMD ["java","-jar","/tmp/SpringBootRestHello-0.0.1-SNAPSHOT.jar"]' vigilant_goldberg spring-boot-hello-world:0.0.1-SNAPSHOT
</pre></td></tr></tbody></table></code></pre></div></div>
<p>Bu komut Containerâ€™Ä±mÄ±zÄ± verilen yeni ad ve etiket ile yeni bir Image olarak kaydeder ve geriye Imageâ€™in Idâ€™sini dÃ¶ner.</p>

<p><img src="/assets/img/posts/spring-boot-docker-2/docker-commit-1.png" alt="Image of ss-docker-commit-1" /></p>

<p><code class="highlighter-rouge">docker images</code> komutu ile sistemdeki tÃ¼m Imageâ€™leri listeleriz ve yeni Imageâ€™in oluÅŸup oluÅŸmadÄ±ÄŸÄ±na bakabiliriz.</p>

<h4 id="iÌ‡Ã§erisinde-jar-olan-containerÄ±-Ã§alÄ±ÅŸtÄ±rma">Ä°Ã§erisinde JAR Olan Containerâ€™Ä± Ã‡alÄ±ÅŸtÄ±rma</h4>

<p>Evet ÅŸu anda Container olarak baÅŸlatÄ±ldÄ±ÄŸÄ±nda ilgili JARâ€™Ä± Ã§alÄ±ÅŸtÄ±racak Docker Imageâ€™Ä±na sahibiz, gelin hep beraber Imageâ€™Ä±mÄ±zÄ± Ã§alÄ±ÅŸtÄ±rÄ±p Spring Boot uygulamamÄ±zÄ±n Ã§alÄ±ÅŸÄ±p Ã§alÄ±ÅŸmadÄ±ÄŸÄ±nÄ± kontrol edelim. AÅŸaÄŸÄ±daki komut ile Imageâ€™Ä±mÄ±zÄ± Ã§alÄ±ÅŸtÄ±rÄ±rÄ±z. Komutun iÃ§indeki <code class="highlighter-rouge">-p 8080:8080</code> ifadesi Spring Boot uygulamamÄ±zÄ±n hangi portta Ã§alÄ±ÅŸacaÄŸÄ±nÄ± ifade ediyor.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>docker run -p 8080:8080 spring-boot-hello-world:0.0.1-SNAPSHOT
</pre></td></tr></tbody></table></code></pre></div></div>
<p>Bu komutu Ã§alÄ±ÅŸtÄ±rdÄ±ÄŸÄ±mÄ±zda aÅŸaÄŸÄ±daki gibi bir hata alÄ±yorsanÄ±z 8080 portunun baÅŸka bir uygulama tarafÄ±ndan kullanÄ±ldÄ±ÄŸÄ±nÄ± anlamalÄ±sÄ±nÄ±z.</p>

<p><img src="/assets/img/posts/spring-boot-docker-2/docker-run-1.png" alt="Image of ss-docker-run-1" /></p>

<p>Bu hatayÄ± gidermek iÃ§in ya 8080 portunu deÄŸiÅŸtirmemiz ya da bu portu mÃ¼sait duruma getirmemiz gerekmektedir. Portumuzu mÃ¼sait hale getirip tekrar aÅŸaÄŸÄ±daki komutu Ã§alÄ±ÅŸtÄ±rdÄ±ÄŸÄ±mÄ±zda;</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>docker run -p 8080:8080 spring-boot-hello-world:0.0.1-SNAPSHOT
</pre></td></tr></tbody></table></code></pre></div></div>

<p>AÅŸaÄŸÄ±daki gibi Containerâ€™Ä±mÄ±z ayaÄŸa kalkar ve iÃ§indeki Spring Boot uygulamasÄ± baÅŸlangÄ±Ã§ Scriptâ€™i olarak Ã§alÄ±ÅŸÄ±r.</p>

<p><img src="/assets/img/posts/spring-boot-docker-2/ss-container-result.png" alt="Image of ss-container-result" /></p>

<p>TarayÄ±cÄ±mÄ±za <code class="highlighter-rouge">localhost:8080/hello</code> Urlâ€™ini girdiÄŸimizde aÅŸaÄŸÄ±daki sayfa karÅŸÄ±mÄ±z gelir.</p>

<p><img src="/assets/img/posts/spring-boot-docker-2/ss-localhost-hello.png" alt="Image of ss-container-result" /></p>

<p><code class="highlighter-rouge">localhost:8080/date</code> Urlâ€™ini girdiÄŸimizde ise aÅŸaÄŸÄ±daki sayfa karÅŸÄ±mÄ±z gelir.</p>

<p><img src="/assets/img/posts/spring-boot-docker-2/ss-localhost-date.png" alt="Image of ss-container-result" /></p>

<p>Evet bu yazÄ±mÄ±zda Spring Boot ile geliÅŸtirdiÄŸimiz basit bir uygulamayÄ± Container iÃ§ine alÄ±p (Containerizing), nasÄ±l Ã§aÄ±ÅŸtÄ±racaÄŸÄ±mÄ±zÄ± Ã¶ÄŸrenmiÅŸ olduk. Ä°ÅŸte tam bu noktada deÄŸinmek istediÄŸim husus ÅŸu ki DEVOPS kÃ¼ltÃ¼rÃ¼nÃ¼n mantÄ±ÄŸÄ± sÃ¼reÃ§leri otomatikleÅŸtirmeye dayanÄ±r. Bu yazÄ±da tam olarak sÃ¼reci otomatize etmiÅŸ olmadÄ±k. Spring Boot uygulamamÄ±zÄ±n build iÅŸlemini tam manasÄ±yla otomatize etmek iÃ§in <code class="highlighter-rouge">DOCKERFILE</code> denen bir yapÄ±ya ihtiyacÄ±mÄ±z var. Yani bu yazÄ±da anlattÄ±ÄŸÄ±mÄ±z tÃ¼m sÃ¼reÃ§leri-komutlarÄ± <code class="highlighter-rouge">DOCKERFILE</code> iÃ§erisine alÄ±yoruz ve bu DOCKERFILEâ€™dan IMAGE oluÅŸturuyoruz ve oluÅŸan IMAGEâ€™i Ã§alÄ±ÅŸtÄ±rÄ±yoruz. Ve elimizdeki DOCKERFILEâ€™Ä±mÄ±zÄ± projemizle beraber paylaÅŸabiliyoruz.</p>

<p>Bir sonraki yazÄ±mÄ±zda DOCKERFILE oluÅŸturmayÄ± inceleyerek yazÄ± serimize devam edeceÄŸiz.</p>

<p><a href="https://turkceyaz.com/">TÃ¼rkÃ§e yazÄ±m kurallarÄ± denetimi iÃ§ini turkceyaz.comâ€™dan faydalanÄ±ldÄ±.</a></p>

:ET